<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ—Å–º–æ—Ç—Ä –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤</title>
    
    <!-- CSS —Ñ–∞–π–ª—ã -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/table.css">
    <link rel="stylesheet" href="css/modals.css">
    <link rel="stylesheet" href="css/animations.css">
    
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.2.2/css/buttons.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/colreorder/1.5.6/css/colReorder.dataTables.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- jQuery –∏ DataTables JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/colreorder/1.5.6/js/dataTables.colReorder.min.js"></script>
</head>
<body>
    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
    <div class="toast-container"></div>
    
    <div class="app-container">
        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="sidebar">
            <div class="logo">
                <div class="logo-text">
                    <span class="logo-top">–í—Å–µ—Ä–æ—Å—Å–∏–π—Å–∫–∏–π</span>
                    <span class="logo-middle">—Å—Ç—É–¥–µ–Ω—á–µ—Å–∫–∏–π</span>
                    <span class="logo-bottom">—Å–æ—é–∑</span>
                </div>
            </div>
            <div class="sidebar-buttons">
                <button id="btn-mailing" class="sidebar-btn">–†–∞—Å—Å—ã–ª–∫–∞</button>
                <button id="btn-view-db" class="sidebar-btn">–ü—Ä–æ—Å–º–æ—Ç—Ä –ë–î</button>
                <button id="btn-update-db" class="sidebar-btn">–û–±–Ω–æ–≤–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö</button>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="main-content">
            <!-- –°–µ–∫—Ü–∏—è –±–∞–Ω–Ω–µ—Ä–∞ -->
            <div class="banner">
                <div class="banner-overlay">
                    <div class="banner-logo">C</div>
                    <div class="help-icon" title="–ü–æ–º–æ—â—å">?</div>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è —Ç–∞–±–ª–∏—Ü—ã -->
            <div class="table-container">
                <div class="table-toolbar">
                    <div class="toolbar-left">
                        <button id="btn-load-file" class="toolbar-btn">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</button>
                        <button id="btn-export" class="toolbar-btn">–≠–∫—Å–ø–æ—Ä—Ç</button>
                        <button id="btn-columns" class="toolbar-btn">–ö–æ–ª–æ–Ω–∫–∏</button>
                        <button id="btn-custom-columns" class="toolbar-btn">–î–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É</button>
                        <button id="btn-presets" class="toolbar-btn">–ü—Ä–µ—Å–µ—Ç—ã</button>
                    </div>
                    <div class="toolbar-right">
                        <input type="text" id="global-search" placeholder="–ü–æ–∏—Å–∫...">
                    </div>
                </div>
                
                <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
                <div id="loading-indicator" class="loading-indicator" style="display: none; opacity: 0; transition: opacity 0.3s ease;">
                    <div class="spinner"></div>
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –ø–æ–¥–æ–∂–¥–∏—Ç–µ...</p>
                </div>
                
                <!-- –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∫–æ–≥–¥–∞ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö -->
                <div id="empty-state" class="empty-state">
                    <div style="font-size: 72px; margin-bottom: 20px;">üìä</div>
                    <h2>–î–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã</h2>
                    <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å</p>
                    <button id="btn-start-upload" class="upload-btn">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</button>
                </div>
                
                <div class="table-wrapper">
                    <table id="data-table" class="display" style="width:100%">
                        <!-- –¢–∞–±–ª–∏—Ü–∞ –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ —Å –ø–æ–º–æ—â—å—é JavaScript -->
                        <thead>
                            <tr>
                                <!-- –ó–∞–≥–æ–ª–æ–≤–∫–∏ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </tr>
                        </thead>
                        <tbody>
                            <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </tbody>
                    </table>
                </div>
                
                <div class="status-bar" id="status-bar" style="opacity: 1; transition: opacity 0.3s ease;">
                    –ì–æ—Ç–æ–≤–æ
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="column-selector-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–í—ã–±–æ—Ä –∫–æ–ª–æ–Ω–æ–∫</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="search-container">
                    <input type="text" id="column-search" placeholder="–ü–æ–∏—Å–∫ –∫–æ–ª–æ–Ω–æ–∫...">
                </div>
                <div class="button-container">
                    <button id="select-all-columns" class="modal-btn">–í—ã–±—Ä–∞—Ç—å –≤—Å–µ</button>
                    <button id="deselect-all-columns" class="modal-btn">–°–Ω—è—Ç—å –≤—Å–µ</button>
                </div>
                <div class="column-list" id="column-list">
                    <!-- –ö–æ–ª–æ–Ω–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
            <div class="modal-footer">
                <button id="apply-columns" class="modal-btn primary">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                <button id="cancel-columns" class="modal-btn">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <div id="filter-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="filter-column-name">–§–∏–ª—å—Ç—Ä –∫–æ–ª–æ–Ω–∫–∏</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="preset-container">
                    <label>–ü—Ä–µ—Å–µ—Ç—ã:</label>
                    <select id="filter-presets">
                        <option value="">–í—ã–±—Ä–∞—Ç—å –ø—Ä–µ—Å–µ—Ç...</option>
                    </select>
                    <button id="apply-preset" class="modal-btn">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                    <button id="save-preset" class="modal-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫...</button>
                </div>
                <div class="search-container">
                    <input type="text" id="filter-search" placeholder="–ü–æ–∏—Å–∫ –∑–Ω–∞—á–µ–Ω–∏–π...">
                </div>
                <div class="button-container">
                    <button id="select-all-values" class="modal-btn">–í—ã–±—Ä–∞—Ç—å –≤—Å–µ</button>
                    <button id="deselect-all-values" class="modal-btn">–°–Ω—è—Ç—å –≤—Å–µ</button>
                </div>
                <div class="value-list" id="value-list">
                    <!-- –ó–Ω–∞—á–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
            <div class="modal-footer">
                <button id="apply-filter" class="modal-btn primary">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                <button id="cancel-filter" class="modal-btn">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <div id="presets-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ—Å–µ—Ç–∞–º–∏</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="preset-selector">
                    <label>–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–µ—Å–µ—Ç—ã:</label>
                    <select id="preset-select">
                        <!-- –ü—Ä–µ—Å–µ—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </select>
                </div>
                <div class="preset-buttons">
                    <button id="apply-preset-btn" class="modal-btn">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                    <button id="rename-preset-btn" class="modal-btn">–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å</button>
                    <button id="delete-preset-btn" class="modal-btn">–£–¥–∞–ª–∏—Ç—å</button>
                    <button id="save-preset-btn" class="modal-btn primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                </div>
                <div class="preset-info" id="preset-info" style="opacity: 1; transition: opacity 0.3s ease;">
                    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–µ—Å–µ—Ç–µ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω–∞ –∑–¥–µ—Å—å -->
                </div>
            </div>
            <div class="modal-footer">
                <button id="close-presets" class="modal-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="export-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞:</p>
                <div class="export-options">
                    <button id="export-csv" class="export-btn">CSV</button>
                    <button id="export-excel" class="export-btn">Excel</button>
                    <button id="export-json" class="export-btn">JSON</button>
                </div>
                <p id="export-info" style="margin-top: 15px; text-align: center; color: var(--text-light);">
                    –ë—É–¥–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ —Ç–æ–ª—å–∫–æ –≤–∏–¥–∏–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏
                </p>
            </div>
            <div class="modal-footer">
                <button id="cancel-export" class="modal-btn">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>  

    <div id="custom-columns-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="custom-columns-form">
                    <label for="custom-column-name">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏:</label>
                    <input type="text" id="custom-column-name" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–ª–æ–Ω–∫–∏">
                    
                    <label for="custom-column-formula">–§–æ—Ä–º—É–ª–∞ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ${columnName} –¥–ª—è —Å—Å—ã–ª–∫–∏ –Ω–∞ –¥—Ä—É–≥–∏–µ –∫–æ–ª–æ–Ω–∫–∏):</label>
                    <textarea id="custom-column-formula" rows="3" 
                              placeholder="–ü—Ä–∏–º–µ—Ä: ${–ò–º—è} + ' ' + ${–§–∞–º–∏–ª–∏—è} - –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –∏–º–µ–Ω–∏ –∏ —Ñ–∞–º–∏–ª–∏–∏"></textarea>
                    
                    <button id="add-custom-column" class="modal-btn primary">–î–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É</button>
                </div>
                
                <hr>
                
                <h3>–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏</h3>
                <div class="saved-columns-list" id="saved-columns-list">
                    <!-- –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                </div>
            </div>
            <div class="modal-footer">
                <button id="close-custom-columns" class="modal-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="file-input-container" style="display: none;">
        <input type="file" id="file-input" accept=".csv,.xlsx,.xls,.xml,.pickle,.pkl,.pck,.pcl">
    </div>

    <!-- JavaScript —Ñ–∞–π–ª—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <script src="js/state.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/table.js"></script>
    <script src="js/modals.js"></script>
    <script src="js/presets.js"></script>
    <script src="js/customColumns.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
</body>
</html>